{% extends "dashboard_1.html" %}
{% block content %}

<div class="row">
    <div class="col-md-3 mb-4">
        <div class="card shadow-sm border-primary h-100">
            <div class="card-body d-flex align-items-center">
                <!-- Icon on the left side -->
                <div class="d-flex justify-content-center align-items-center me-3" style="width: 50px; height: 50px; background-color: #f2f7ff; border-radius: 8px;">
                    <i class="bi bi-people-fill fs-2 text-primary"></i>
                </div>
                <!-- Title and total on the right side -->
                <div>
                    <h5 class="card-title text-primary fs-5 mb-1">
                        Total Users
                    </h5>
                    <p class="display-6 fw-bold text-dark mb-0 text-center">
                        {{ admin_stats.total_users }}
                    </p>
                </div>
            </div>
        </div>
    </div>
    

    <div class="col-md-3 mb-4">
        <div class="card shadow-sm border-primary h-100">
            <div class="card-body d-flex align-items-center">
                <div class="d-flex justify-content-center align-items-center me-3" style="width: 50px; height: 50px; background-color: #f2f7ff; border-radius: 8px;">
                    <i class="bi bi-shop fs-2 text-success"></i>
                </div>

                <div>
                    <h5 class="card-title text-success fs-5 mb-1">
                        Total Sellers
                    </h5>

                    <p class="display-6 fw-bold text-dark mb-0 text-center">
                        {{ admin_stats.total_sellers }}
                    </p>
                </div>

                <!-- <h5 class="card-title text-success fs-4">
                    <i class="bi bi-shop me-2"></i>Total Sellers
                </h5>
                <p class="display-6 fw-bold text-dark">{{ admin_stats.total_sellers }}</p> -->
            </div>
        </div>
    </div>

    <div class="col-md-3 mb-4">

        <div class="card shadow-sm border-primary h-100">
            <div class="card-body d-flex align-items-center">
                <!-- Icon on the left side -->
                <div class="d-flex justify-content-center align-items-center me-3" style="width: 50px; height: 50px; background-color: #f2f7ff; border-radius: 8px;">
                    <i class="bi bi-truck fs-2 text-warning"></i>
                </div>
                <!-- Title and total on the right side -->
                <div>
                    <h5 class="card-title text-warning fs-5 mb-1">
                        Total Couriers
                    </h5>
                    <p class="display-6 fw-bold text-dark mb-0 text-center">
                        {{ admin_stats.total_couriers }}
                    </p>
                </div>
            </div>
        </div>


        <!-- <div class="card text-center shadow-sm border-warning h-100">
            <div class="card-body">
                <h5 class="card-title text-warning fs-4">
                    <i class="bi bi-truck me-2"></i>Total Couriers
                </h5>
                <p class="display-6 fw-bold text-dark">{{ admin_stats.total_couriers }}</p>
            </div>
        </div> -->
    </div>

    <div class="col-md-3 mb-4">

        <div class="card shadow-sm border-primary h-100">
            <div class="card-body d-flex align-items-center">
                <!-- Icon on the left side -->
                <div class="d-flex justify-content-center align-items-center me-3" style="width: 50px; height: 50px; background-color: #f2f7ff; border-radius: 8px;">
                    <i class="bi bi-box-seam fs-2 text-info"></i>
                </div>
                <!-- Title and total on the right side -->
                <div>
                    <h5 class="card-title text-info fs-5 mb-1">
                        Total Product
                    </h5>
                    <p class="display-6 fw-bold text-dark mb-0 text-center">
                        {{ admin_stats.total_products }}
                    </p>
                </div>
            </div>
        </div>

        <!-- <div class="card text-center shadow-sm border-info h-100">
            <div class="card-body">
                <h5 class="card-title text-info fs-4">
                    <i class="bi bi-box-seam me-2"></i>Total Products
                </h5>
                <p class="display-6 fw-bold text-dark">{{ admin_stats.total_products }}</p>
            </div>
        </div> -->
    </div>


<!-- <div class="col-md-3 mb-4">
    <div class="card text-center shadow-sm border-secondary h-100">
        <div class="card-body">
            <h5 class="card-title text-secondary fs-4">
                <i class="bi bi-cash-coin me-2"></i>Total Admin Income
            </h5>
            <p class="display-6 fw-bold text-dark">₱{{ admin_stats.total_admin_income | round(2) }}</p>
        </div>
    </div>
</div> -->

<!-- <div class="col-md-3 mb-4">
    <div class="card text-center shadow-sm border-dark h-100">
        <div class="card-body">
            <h5 class="card-title text-dark fs-4">
                <i class="bi bi-truck-flatbed me-2"></i>Total Shipping Income
            </h5>
            <p class="display-6 fw-bold text-dark">₱{{ admin_stats.total_shipping_income | round(2) }}</p>
        </div>
    </div>
</div> -->

</div>


<div class="row">
    <div class="col-12 col-lg-12 order-1 order-md-3 order-lg-2 mb-4">
        <div class="card">
            <div class="row row-bordered g-0">
            <div class="col-md-12">
                <div class="d-flex justify-content-between align-items-center p-3">
                    <h5 class="m-0">Total Admin Comissions</h5>
                    <p class="display-6 fw-bold mb-0 text-primary">₱{{ admin_stats.total_admin_income | round(2) }}</p>

                </div>

                <div id="totalRevenueCharts" class="px-2"></div>
            </div>
           
            </div>
        </div>
    </div>
</div>

<div class="row">
   

    <div class="col-md-12 col-lg-8 order-1 mb-4">
    <div class="card h-100">
        <div class="card-header">
        <ul class="nav nav-pills" role="tablist">
            <li class="nav-item">
            <button
                type="button"
                class="nav-link active"
                role="tab"
                data-bs-toggle="tab"
                data-bs-target="#navs-tabs-line-card-income"
                aria-controls="navs-tabs-line-card-income"
                aria-selected="true"
            >
                Shipping Income
            </button>
            </li>
  
        </ul>
        </div>
        <div class="card-body px-0">
        <div class="tab-content p-0">
            <div class="tab-pane fade show active" id="navs-tabs-line-card-income" role="tabpanel">
            <div class="d-flex p-4 pt-3">
                <div class="avatar flex-shrink-0 me-3">
                <img src="../static/img/wallet.png" alt="User" />
                </div>
                <div>
                <small class="text-muted d-block">Total Balance</small>
                <div class="d-flex align-items-center">
                    <h6 class="mb-0 me-1">₱{{ admin_stats.total_shipping_income | round(2) }}</h6>
                   
                </div>
                </div>
            </div>
            <div id="incomeCharts"></div>
          
            </div>
        </div>
        </div>
    </div>
    </div>

    <div class="col-md-6 col-lg-4 order-2 mb-4">
    <div class="card h-100">
        <div class="card-header d-flex align-items-center justify-content-between">
        <h5 class="card-title m-0 me-2">Transactions</h5>
        <div class="dropdown">
            <button
            class="btn p-0"
            type="button"
            id="transactionID"
            data-bs-toggle="dropdown"
            aria-haspopup="true"
            aria-expanded="false"
            >
            <i class="bx bx-dots-vertical-rounded"></i>
            </button>
            <div class="dropdown-menu dropdown-menu-end" aria-labelledby="transactionID">
            <a class="dropdown-item" href="javascript:void(0);">Last 28 Days</a>
            <a class="dropdown-item" href="javascript:void(0);">Last Month</a>
            <a class="dropdown-item" href="javascript:void(0);">Last Year</a>
            </div>
        </div>
        </div>
        <div class="card-body">
            <ul class="p-0 m-0">
                {% for transaction in admin_commissions %}
                    <li class="d-flex mb-4 pb-1">
                        <div class="avatar flex-shrink-0 me-3">
                            <img src="../static/img/wallet.png" alt="User" class="rounded" />
                        </div>
                        <div class="d-flex w-100 flex-wrap align-items-center justify-content-between gap-2">
                            <div class="me-2">
                                <small class="text-muted d-block mb-1">Cash on Delivery</small>  <!-- Adjust this if necessary -->
                                <h6 class="mb-0">Order ID: {{ transaction.order_id }}</h6>  <!-- You can customize this -->
                            </div>
                            <div class="user-progress d-flex align-items-center gap-1">
                                <h6 class="mb-0">+{{ transaction.admin_commission | round(2) }}</h6>
                                <span class="text-muted">PHP</span>
                            </div>
                        </div>
                    </li>
                {% endfor %}
            </ul>
        </div>
    </div>
    </div>
</div>




<script>
    const totalRevenueChartsEl = document.querySelector('#totalRevenueCharts');

    fetch('/admin-profit-data')
        .then(response => response.json())
        .then(data => {
            const totalRevenueChartsOptions = {
                series: data.series,
                chart: {
                    height: 300,
                    stacked: true,
                    type: 'bar',
                    toolbar: { show: false }
                },
                plotOptions: {
                    bar: {
                        horizontal: false,
                        columnWidth: '33%',
                        borderRadius: 10
                    }
                },
                colors: ['#696cff', '#00E396'], // Customize colors
                dataLabels: { enabled: false },
                stroke: {
                    curve: 'smooth',
                    width: 6,
                    lineCap: 'round',
                    colors: ['#FFFFFF']
                },
                legend: {
                    show: true,
                    horizontalAlign: 'left',
                    position: 'top',
                    markers: {
                        height: 8,
                        width: 8,
                        radius: 12
                    },
                    itemMargin: { horizontal: 10 }
                },
                grid: {
                    borderColor: '#e7e7e7',
                    padding: { top: 0, bottom: -8, left: 20, right: 20 }
                },
                xaxis: {
                    categories: data.categories,
                    labels: { style: { fontSize: '13px', colors: ['#9c9c9c'] } }
                },
                yaxis: {
                    labels: { style: { fontSize: '13px', colors: ['#9c9c9c'] } }
                },
                responsive: [
                    {
                        breakpoint: 768,
                        options: {
                            plotOptions: { bar: { columnWidth: '48%' } }
                        }
                    }
                ]
            };

            if (totalRevenueChartsEl !== null) {
                const totalRevenueCharts = new ApexCharts(totalRevenueChartsEl, totalRevenueChartsOptions);
                totalRevenueCharts.render();
            }
        })
        .catch(error => console.error('Error loading sales data:', error));



        
</script>


<script>
    const incomeChartEl = document.querySelector('#incomeCharts');

    fetch('/monthly-shipping-income')
        .then(response => response.json())
        .then(data => {
            const incomeChartConfig = {
                series: data.series,
                chart: {
                    height: 215,
                    parentHeightOffset: 0,
                    parentWidthOffset: 0,
                    toolbar: { show: false },
                    type: 'area'
                },
                dataLabels: { enabled: false },
                stroke: {
                    width: 2,
                    curve: 'smooth'
                },
                legend: { show: false },
            
                colors: ['#696cff'], // Primary color for the chart
                fill: {
                    type: 'gradient',
                    gradient: {
                        shade: 'light',
                        shadeIntensity: 0.6,
                        opacityFrom: 0.5,
                        opacityTo: 0.25,
                        stops: [0, 95, 100]
                    }
                },
                grid: {
                    borderColor: '#e7e7e7',
                    strokeDashArray: 3,
                    padding: {
                        top: -20,
                        bottom: -8,
                        left: -10,
                        right: 8
                    }
                },
                xaxis: {
                    categories: data.categories,
                    axisBorder: { show: false },
                    axisTicks: { show: false },
                    labels: {
                        show: true,
                        style: { fontSize: '13px', colors: '#9c9c9c' }
                    }
                },
                yaxis: {
                    labels: { show: false },
                    min: 0,
                    max: Math.max(...data.series[0].data) + 10, // Dynamic max value
                    tickAmount: 4
                }
            };

            if (incomeChartEl !== null) {
                const incomeChart = new ApexCharts(incomeChartEl, incomeChartConfig);
                incomeChart.render();
            }
        })
        .catch(error => console.error('Error loading shipping income data:', error));
</script>

      <script>localStorage.clear();</script>




{% endblock %}